diff --git a/tests/unit/email-service.test.ts b/tests/unit/email-service.test.ts
@@
-      delete require.cache[require.resolve('../../server/services/email-service')];
-      const { emailService } = require('../../server/services/email-service');
+      vi.resetModules();
+      const { emailService } = await import('../../server/services/email-service.ts');
@@
-      delete require.cache[require.resolve('../../server/services/email-service')];
-      const { emailService } = require('../../server/services/email-service');
+      vi.resetModules();
+      const { emailService } = await import('../../server/services/email-service.ts');
@@
-      delete require.cache[require.resolve('../../server/services/email-service')];
-      const { emailService } = require('../../server/services/email-service');
+      vi.resetModules();
+      const { emailService } = await import('../../server/services/email-service.ts');
@@
-      delete require.cache[require.resolve('../../server/services/email-service')];
-      const { emailService } = require('../../server/services/email-service');
+      vi.resetModules();
+      const { emailService } = await import('../../server/services/email-service.ts');
@@
-      delete require.cache[require.resolve('../../server/services/email-service')];
-      const { emailService } = require('../../server/services/email-service');
+      vi.resetModules();
+      const { emailService } = await import('../../server/services/email-service.ts');
@@
-      delete require.cache[require.resolve('../../server/services/email-service')];
-      const { emailService } = require('../../server/services/email-service');
+      vi.resetModules();
+      const { emailService } = await import('../../server/services/email-service.ts');
@@
-      delete require.cache[require.resolve('../../server/services/email-service')];
-      const { emailService } = require('../../server/services/email-service');
+      vi.resetModules();
+      const { emailService } = await import('../../server/services/email-service.ts');
@@
-      delete require.cache[require.resolve('../../server/services/email-service')];
-      const { emailService } = require('../../server/services/email-service');
+      vi.resetModules();
+      const { emailService } = await import('../../server/services/email-service.ts');
@@
-      delete require.cache[require.resolve('../../server/services/email-service')];
-      const { emailService } = require('../../server/services/email-service');
+      vi.resetModules();
+      const { emailService } = await import('../../server/services/email-service.ts');
@@
-      delete require.cache[require.resolve('../../server/services/email-service')];
-      const { emailService } = require('../../server/services/email-service');
+      vi.resetModules();
+      const { emailService } = await import('../../server/services/email-service.ts');
