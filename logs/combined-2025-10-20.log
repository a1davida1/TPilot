{"date":"Mon Oct 20 2025 07:49:56 GMT-0500 (Central Daylight Time)","error":{},"level":"error","message":"unhandledRejection: caption request failed\nError: caption request failed\n    at /home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:99:13\n    at retryWithBackoff (/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:27:14)\n    at captionImage (/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:89:15)\n    at Module.nsfwCaptionFallback (/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:120:19)","os":{"loadavg":[2.28,2.02,2.07],"uptime":11059.3},"process":{"argv":["/usr/bin/node","/home/dave/CascadeProjects/TPilot/node_modules/tinypool/dist/entry/process.js"],"cwd":"/home/dave/CascadeProjects/TPilot","execPath":"/usr/bin/node","gid":1000,"memoryUsage":{"arrayBuffers":598055,"external":4348784,"heapTotal":190574592,"heapUsed":168115096,"rss":281014272},"pid":35183,"uid":1000,"version":"v20.19.5"},"rejection":true,"stack":"Error: caption request failed\n    at /home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:99:13\n    at retryWithBackoff (/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:27:14)\n    at captionImage (/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:89:15)\n    at Module.nsfwCaptionFallback (/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:120:19)","timestamp":"2025-10-20T12:49:56.450Z","trace":[{"column":13,"file":"/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts","function":null,"line":99,"method":null,"native":false},{"column":14,"file":"/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts","function":"retryWithBackoff","line":27,"method":null,"native":false},{"column":15,"file":"/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts","function":"captionImage","line":89,"method":null,"native":false},{"column":19,"file":"/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts","function":"Module.nsfwCaptionFallback","line":120,"method":"nsfwCaptionFallback","native":false}]}
{"date":"Mon Oct 20 2025 07:50:20 GMT-0500 (Central Daylight Time)","error":{},"level":"error","message":"unhandledRejection: caption request failed\nError: caption request failed\n    at /home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:99:13\n    at retryWithBackoff (/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:27:14)\n    at captionImage (/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:89:15)\n    at Module.nsfwCaptionFallback (/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:120:19)","os":{"loadavg":[2.3,2.03,2.08],"uptime":11082.93},"process":{"argv":["/usr/bin/node","/home/dave/CascadeProjects/TPilot/node_modules/tinypool/dist/entry/process.js"],"cwd":"/home/dave/CascadeProjects/TPilot","execPath":"/usr/bin/node","gid":1000,"memoryUsage":{"arrayBuffers":590407,"external":4333523,"heapTotal":178532352,"heapUsed":153616456,"rss":259694592},"pid":35557,"uid":1000,"version":"v20.19.5"},"rejection":true,"stack":"Error: caption request failed\n    at /home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:99:13\n    at retryWithBackoff (/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:27:14)\n    at captionImage (/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:89:15)\n    at Module.nsfwCaptionFallback (/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:120:19)","timestamp":"2025-10-20T12:50:20.081Z","trace":[{"column":13,"file":"/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts","function":null,"line":99,"method":null,"native":false},{"column":14,"file":"/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts","function":"retryWithBackoff","line":27,"method":null,"native":false},{"column":15,"file":"/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts","function":"captionImage","line":89,"method":null,"native":false},{"column":19,"file":"/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts","function":"Module.nsfwCaptionFallback","line":120,"method":"nsfwCaptionFallback","native":false}]}
{"date":"Mon Oct 20 2025 08:07:49 GMT-0500 (Central Daylight Time)","error":{},"level":"error","message":"unhandledRejection: caption request failed\nError: caption request failed\n    at /home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:99:13\n    at retryWithBackoff (/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:27:14)\n    at captionImage (/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:89:15)\n    at Module.nsfwCaptionFallback (/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:120:19)","os":{"loadavg":[2.7,1.97,2.02],"uptime":12132.16},"process":{"argv":["/usr/bin/node","/home/dave/CascadeProjects/TPilot/node_modules/tinypool/dist/entry/process.js"],"cwd":"/home/dave/CascadeProjects/TPilot","execPath":"/usr/bin/node","gid":1000,"memoryUsage":{"arrayBuffers":622981,"external":4372866,"heapTotal":197300224,"heapUsed":172731800,"rss":275644416},"pid":38657,"uid":1000,"version":"v20.19.5"},"rejection":true,"stack":"Error: caption request failed\n    at /home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:99:13\n    at retryWithBackoff (/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:27:14)\n    at captionImage (/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:89:15)\n    at Module.nsfwCaptionFallback (/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:120:19)","timestamp":"2025-10-20T13:07:49.312Z","trace":[{"column":13,"file":"/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts","function":null,"line":99,"method":null,"native":false},{"column":14,"file":"/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts","function":"retryWithBackoff","line":27,"method":null,"native":false},{"column":15,"file":"/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts","function":"captionImage","line":89,"method":null,"native":false},{"column":19,"file":"/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts","function":"Module.nsfwCaptionFallback","line":120,"method":"nsfwCaptionFallback","native":false}]}
{"date":"Mon Oct 20 2025 08:13:10 GMT-0500 (Central Daylight Time)","error":{},"level":"error","message":"unhandledRejection: caption request failed\nError: caption request failed\n    at /home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:99:13\n    at retryWithBackoff (/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:27:14)\n    at captionImage (/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:89:15)\n    at Module.nsfwCaptionFallback (/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:120:19)","os":{"loadavg":[3.17,2.84,2.41],"uptime":12453.29},"process":{"argv":["/usr/bin/node","/home/dave/CascadeProjects/TPilot/node_modules/tinypool/dist/entry/process.js"],"cwd":"/home/dave/CascadeProjects/TPilot","execPath":"/usr/bin/node","gid":1000,"memoryUsage":{"arrayBuffers":580782,"external":4344559,"heapTotal":171737088,"heapUsed":146746456,"rss":248700928},"pid":40374,"uid":1000,"version":"v20.19.5"},"rejection":true,"stack":"Error: caption request failed\n    at /home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:99:13\n    at retryWithBackoff (/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:27:14)\n    at captionImage (/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:89:15)\n    at Module.nsfwCaptionFallback (/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:120:19)","timestamp":"2025-10-20T13:13:10.441Z","trace":[{"column":13,"file":"/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts","function":null,"line":99,"method":null,"native":false},{"column":14,"file":"/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts","function":"retryWithBackoff","line":27,"method":null,"native":false},{"column":15,"file":"/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts","function":"captionImage","line":89,"method":null,"native":false},{"column":19,"file":"/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts","function":"Module.nsfwCaptionFallback","line":120,"method":"nsfwCaptionFallback","native":false}]}
{"date":"Mon Oct 20 2025 08:13:33 GMT-0500 (Central Daylight Time)","error":{},"level":"error","message":"unhandledRejection: caption request failed\nError: caption request failed\n    at /home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:99:13\n    at retryWithBackoff (/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:27:14)\n    at captionImage (/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:89:15)\n    at Module.nsfwCaptionFallback (/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:120:19)","os":{"loadavg":[3.26,2.87,2.42],"uptime":12476.73},"process":{"argv":["/usr/bin/node","/home/dave/CascadeProjects/TPilot/node_modules/tinypool/dist/entry/process.js"],"cwd":"/home/dave/CascadeProjects/TPilot","execPath":"/usr/bin/node","gid":1000,"memoryUsage":{"arrayBuffers":518357,"external":4223241,"heapTotal":196476928,"heapUsed":161597840,"rss":280477696},"pid":40650,"uid":1000,"version":"v20.19.5"},"rejection":true,"stack":"Error: caption request failed\n    at /home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:99:13\n    at retryWithBackoff (/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:27:14)\n    at captionImage (/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:89:15)\n    at Module.nsfwCaptionFallback (/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:120:19)","timestamp":"2025-10-20T13:13:33.877Z","trace":[{"column":13,"file":"/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts","function":null,"line":99,"method":null,"native":false},{"column":14,"file":"/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts","function":"retryWithBackoff","line":27,"method":null,"native":false},{"column":15,"file":"/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts","function":"captionImage","line":89,"method":null,"native":false},{"column":19,"file":"/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts","function":"Module.nsfwCaptionFallback","line":120,"method":"nsfwCaptionFallback","native":false}]}
{"level":"warn","message":"⚠️ Turnstile not configured - bypassing verification in development","timestamp":"2025-10-20T13:14:11.489Z"}
{"level":"info","message":"[Gemini] Text model: gemini-2.5-flash","timestamp":"2025-10-20T13:14:11.729Z"}
{"level":"info","message":"[Gemini] Vision model: gemini-2.5-flash","timestamp":"2025-10-20T13:14:11.729Z"}
{"level":"info","message":"[OpenRouter] Default model: x-ai/grok-4-fast","timestamp":"2025-10-20T13:14:11.730Z"}
{"level":"info","message":"REDIS_URL not configured, cache disabled","timestamp":"2025-10-20T13:14:11.764Z"}
{"level":"info","message":"Session store configured with PostgreSQL backend","timestamp":"2025-10-20T13:14:11.773Z"}
{"apiPrefix":"/api","level":"info","loginRoute":"/api/auth/login","message":"Setting up auth routes","signupRoute":"/api/auth/signup","timestamp":"2025-10-20T13:14:11.774Z"}
{"err":{"cause":{"code":"28P01","file":"auth.c","length":100,"line":"331","name":"error","routine":"auth_failed","severity":"FATAL"},"params":["admin@example.com","admin",1],"query":"select \"id\", \"username\", \"password\", \"email\", \"role\", \"is_admin\", \"email_verified\", \"first_name\", \"last_name\", \"tier\", \"must_change_password\", \"subscription_status\", \"trial_ends_at\", \"provider\", \"provider_id\", \"avatar\", \"bio\", \"referral_code_id\", \"referred_by\", \"reddit_username\", \"reddit_access_token\", \"reddit_refresh_token\", \"reddit_id\", \"stripe_customer_id\", \"stripe_subscription_id\", \"catbox_userhash\", \"banned_at\", \"suspended_until\", \"ban_reason\", \"suspension_reason\", \"created_at\", \"updated_at\", \"last_login\", \"password_reset_at\", \"deleted_at\", \"is_deleted\", \"avatar_url\", \"website\", \"timezone\", \"language\", \"two_factor_enabled\", \"last_login_at\", \"password_hash\", \"last_password_change\", \"posts_count\", \"captions_generated\" from \"users\" where (\"users\".\"email\" = $1 or \"users\".\"username\" = $2) limit $3"},"level":"error","message":"Failed to ensure admin account exists","timestamp":"2025-10-20T13:14:11.780Z"}
{"level":"error","message":"⚠️ Set ADMIN_PASSWORD or ADMIN_PASSWORD_HASH in production!","timestamp":"2025-10-20T13:14:11.780Z"}
{"level":"info","message":"🔧 Applying production database fixes...","timestamp":"2025-10-20T13:14:11.781Z"}
{"error":{"cause":{"code":"28P01","file":"auth.c","length":100,"line":"331","name":"error","routine":"auth_failed","severity":"FATAL"},"params":["admin@example.com","admin",1],"query":"select \"id\", \"username\", \"password\", \"email\", \"role\", \"is_admin\", \"email_verified\", \"first_name\", \"last_name\", \"tier\", \"must_change_password\", \"subscription_status\", \"trial_ends_at\", \"provider\", \"provider_id\", \"avatar\", \"bio\", \"referral_code_id\", \"referred_by\", \"reddit_username\", \"reddit_access_token\", \"reddit_refresh_token\", \"reddit_id\", \"stripe_customer_id\", \"stripe_subscription_id\", \"catbox_userhash\", \"banned_at\", \"suspended_until\", \"ban_reason\", \"suspension_reason\", \"created_at\", \"updated_at\", \"last_login\", \"password_reset_at\", \"deleted_at\", \"is_deleted\", \"avatar_url\", \"website\", \"timezone\", \"language\", \"two_factor_enabled\", \"last_login_at\", \"password_hash\", \"last_password_change\", \"posts_count\", \"captions_generated\" from \"users\" where (\"users\".\"email\" = $1 or \"users\".\"username\" = $2) limit $3"},"level":"error","message":"❌ Failed to apply production fixes","timestamp":"2025-10-20T13:14:11.787Z"}
{"date":"Mon Oct 20 2025 08:42:13 GMT-0500 (Central Daylight Time)","error":{},"level":"error","message":"unhandledRejection: caption request failed\nError: caption request failed\n    at /home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:99:13\n    at retryWithBackoff (/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:27:14)\n    at captionImage (/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:89:15)\n    at Module.nsfwCaptionFallback (/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:120:19)","os":{"loadavg":[1.82,1.94,2.12],"uptime":14196.17},"process":{"argv":["/usr/bin/node","/home/dave/CascadeProjects/TPilot/node_modules/tinypool/dist/entry/process.js"],"cwd":"/home/dave/CascadeProjects/TPilot","execPath":"/usr/bin/node","gid":1000,"memoryUsage":{"arrayBuffers":545376,"external":4262360,"heapTotal":166649856,"heapUsed":139126008,"rss":243376128},"pid":45751,"uid":1000,"version":"v20.19.5"},"rejection":true,"stack":"Error: caption request failed\n    at /home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:99:13\n    at retryWithBackoff (/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:27:14)\n    at captionImage (/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:89:15)\n    at Module.nsfwCaptionFallback (/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts:120:19)","timestamp":"2025-10-20T13:42:13.315Z","trace":[{"column":13,"file":"/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts","function":null,"line":99,"method":null,"native":false},{"column":14,"file":"/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts","function":"retryWithBackoff","line":27,"method":null,"native":false},{"column":15,"file":"/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts","function":"captionImage","line":89,"method":null,"native":false},{"column":19,"file":"/home/dave/CascadeProjects/TPilot/server/caption/nsfwFallback.ts","function":"Module.nsfwCaptionFallback","line":120,"method":"nsfwCaptionFallback","native":false}]}
{"level":"info","message":"Sentry initialized successfully","timestamp":"2025-10-20T18:55:06.141Z"}
{"level":"info","message":"[Gemini] Text model: gemini-2.5-flash","timestamp":"2025-10-20T18:55:07.239Z"}
{"level":"info","message":"[Gemini] Vision model: gemini-2.5-flash","timestamp":"2025-10-20T18:55:07.240Z"}
{"level":"info","message":"[OpenRouter] Default model: x-ai/grok-4-fast","timestamp":"2025-10-20T18:55:07.240Z"}
{"level":"info","message":"[HEALTH] Script executed directly, starting bootstrap...","timestamp":"2025-10-20T18:55:07.536Z"}
{"level":"info","message":"[HEALTH] Starting application bootstrap...","timestamp":"2025-10-20T18:55:07.536Z"}
{"level":"info","message":"[HEALTH] Environment: development","timestamp":"2025-10-20T18:55:07.537Z"}
{"level":"info","message":"[HEALTH] Platform: linux","timestamp":"2025-10-20T18:55:07.537Z"}
{"level":"info","message":"[HEALTH] Architecture: x64","timestamp":"2025-10-20T18:55:07.537Z"}
{"error":"connect ECONNREFUSED 127.0.0.1:6379","level":"warn","message":"Redis cache error, falling back to no-cache mode","timestamp":"2025-10-20T18:55:07.546Z"}
{"level":"warn","message":"Redis cache connection closed","timestamp":"2025-10-20T18:55:07.547Z"}
{"error":"Connection is closed.","level":"warn","message":"Failed to connect to Redis cache","timestamp":"2025-10-20T18:55:07.547Z"}
{"level":"info","message":"Using memory store for rate limiting (Redis disabled for beta)","timestamp":"2025-10-20T18:55:07.550Z"}
{"level":"info","message":"Rate limiter using memory store for api","timestamp":"2025-10-20T18:55:07.550Z"}
{"level":"info","message":"Rate limiter using memory store for posts","timestamp":"2025-10-20T18:55:07.553Z"}
{"level":"info","message":"Rate limiter using memory store for captions","timestamp":"2025-10-20T18:55:07.553Z"}
{"level":"info","message":"Rate limiter using memory store for default","timestamp":"2025-10-20T18:55:07.554Z"}
{"endpoints":["api","auth","posting","captions","upload","feedback","passwordReset"],"level":"info","message":"Rate limiting middleware configured","redisAvailable":false,"timestamp":"2025-10-20T18:55:07.555Z"}
{"level":"info","message":"Advanced rate limiting applied","timestamp":"2025-10-20T18:55:07.555Z"}
{"level":"info","message":"Observability middleware configured","timestamp":"2025-10-20T18:55:07.562Z"}
{"level":"info","message":"Observability middleware applied","timestamp":"2025-10-20T18:55:07.563Z"}
{"level":"info","message":"Session store configured with PostgreSQL backend","timestamp":"2025-10-20T18:55:07.564Z"}
{"apiPrefix":"/api","level":"info","loginRoute":"/api/auth/login","message":"Setting up auth routes","signupRoute":"/api/auth/signup","timestamp":"2025-10-20T18:55:07.565Z"}
{"error":"connect ECONNREFUSED 127.0.0.1:6379","level":"warn","message":"Redis cache error, falling back to no-cache mode","timestamp":"2025-10-20T18:55:07.648Z"}
{"level":"warn","message":"Redis cache connection closed","timestamp":"2025-10-20T18:55:07.648Z"}
{"error":"connect ECONNREFUSED 127.0.0.1:6379","level":"warn","message":"Redis cache error, falling back to no-cache mode","timestamp":"2025-10-20T18:55:07.849Z"}
{"level":"warn","message":"Redis cache connection closed","timestamp":"2025-10-20T18:55:07.849Z"}
{"error":"connect ECONNREFUSED 127.0.0.1:6379","level":"warn","message":"Redis cache error, falling back to no-cache mode","timestamp":"2025-10-20T18:55:08.149Z"}
{"level":"warn","message":"Redis connection failed after 3 retries, disabling cache","timestamp":"2025-10-20T18:55:08.150Z"}
{"level":"warn","message":"Redis cache connection closed","timestamp":"2025-10-20T18:55:08.150Z"}
{"email":"admin@thottopilot.com","level":"info","message":"Admin account configured successfully","timestamp":"2025-10-20T18:55:08.462Z","username":"admin@thottopilot.com"}
{"level":"info","message":"🔧 Applying production database fixes...","timestamp":"2025-10-20T18:55:08.463Z"}
{"level":"info","message":"✅ Admin account verified: admin@thottopilot.com","timestamp":"2025-10-20T18:55:08.550Z"}
{"level":"info","message":"User a1davida1 already has tier: pro","timestamp":"2025-10-20T18:55:08.642Z"}
{"level":"info","message":"User a1davida1 email already verified","timestamp":"2025-10-20T18:55:08.733Z"}
{"level":"info","message":"✅ Production database fixes completed","timestamp":"2025-10-20T18:55:08.733Z"}
{"level":"info","message":"Initializing queue system...","timestamp":"2025-10-20T18:55:08.735Z"}
{"level":"info","message":"Queue backend selection: USE_PG_QUEUE=true, REDIS_URL=true","timestamp":"2025-10-20T18:55:08.735Z"}
{"level":"info","message":"🔧 Using PostgreSQL queue backend","timestamp":"2025-10-20T18:55:08.735Z"}
{"level":"error","message":"🔧 Initializing PostgreSQL Queue backend","timestamp":"2025-10-20T18:55:08.736Z"}
{"level":"info","message":"Queue system initialized","timestamp":"2025-10-20T18:55:08.736Z"}
{"level":"error","message":"🔍 Starting queue monitoring...","timestamp":"2025-10-20T18:55:08.742Z"}
{"level":"error","message":"✅ Queue monitoring started (interval: 30000ms)","timestamp":"2025-10-20T18:55:10.913Z"}
{"level":"info","message":"Background workers initialized","timestamp":"2025-10-20T18:55:10.913Z"}
{"level":"info","message":"🚀 Starting cron job manager...","timestamp":"2025-10-20T18:55:10.914Z"}
{"level":"info","message":"✅ Started cron job: process-scheduled-posts (* * * * *)","timestamp":"2025-10-20T18:55:10.943Z"}
{"level":"info","message":"✅ Started cron job: cleanup-old-posts (0 3 * * *)","timestamp":"2025-10-20T18:55:10.948Z"}
{"level":"info","message":"✅ Started cron job: update-analytics (0 * * * *)","timestamp":"2025-10-20T18:55:10.952Z"}
{"level":"info","message":"✅ Started cron job: check-stuck-jobs (*/5 * * * *)","timestamp":"2025-10-20T18:55:10.957Z"}
{"level":"info","message":"✅ Started cron job: sync-reddit-communities (0 2 * * 1)","timestamp":"2025-10-20T18:55:10.966Z"}
{"level":"info","message":"✅ Started cron job: database-backup (0 4 * * *)","timestamp":"2025-10-20T18:55:10.971Z"}
{"level":"info","message":"✅ Started cron job: poll-caption-metrics (15 * * * *)","timestamp":"2025-10-20T18:55:10.976Z"}
{"level":"info","message":"✅ Started cron job: update-optimal-times (0 3 * * 0)","timestamp":"2025-10-20T18:55:10.987Z"}
{"level":"info","message":"✅ Started cron job: daily-health-checks (0 2 * * *)","timestamp":"2025-10-20T18:55:10.992Z"}
{"level":"info","message":"✅ Cron job manager started successfully","timestamp":"2025-10-20T18:55:10.992Z"}
{"level":"info","message":"Cron manager started","timestamp":"2025-10-20T18:55:10.992Z"}
{"level":"info","message":"Queue monitoring started (interval: 30000ms)","timestamp":"2025-10-20T18:55:10.993Z"}
{"level":"info","message":"Worker auto-scaling started (interval: 60000ms)","timestamp":"2025-10-20T18:55:10.997Z"}
{"level":"info","message":"Serving client from: /home/dave/CascadeProjects/TPilot/client","timestamp":"2025-10-20T18:55:11.297Z"}
{"level":"info","message":"Vite development server configured","timestamp":"2025-10-20T18:55:11.803Z"}
{"level":"info","message":"[HEALTH] Express app created successfully in 4267ms","timestamp":"2025-10-20T18:55:11.803Z"}
{"level":"info","message":"[HEALTH] Target port from environment: 3005","timestamp":"2025-10-20T18:55:11.803Z"}
{"level":"info","message":"[HEALTH] Starting server on 0.0.0.0:3005","timestamp":"2025-10-20T18:55:11.804Z"}
{"level":"info","message":"[HEALTH] ✅ Server started successfully on port 3005 in 4269ms","timestamp":"2025-10-20T18:55:11.805Z"}
{"level":"info","message":"serving on port 3005","timestamp":"2025-10-20T18:55:11.805Z"}
{"correlationId":"0671cd00-5bb9-4861-957f-3e012010586d","ip":"127.0.0.1","level":"info","message":"Request received","method":"GET","path":"/api/csrf-token","query":{},"timestamp":"2025-10-20T18:55:19.629Z","userAgent":"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0"}
{"correlationId":"0671cd00-5bb9-4861-957f-3e012010586d","duration":517,"level":"info","message":"Response sent","method":"GET","path":"/api/csrf-token","statusCode":200,"timestamp":"2025-10-20T18:55:20.145Z"}
{"level":"info","message":"Sentry initialized successfully","timestamp":"2025-10-20T18:56:18.484Z"}
{"level":"info","message":"[Gemini] Text model: gemini-2.5-flash","timestamp":"2025-10-20T18:56:19.258Z"}
{"level":"info","message":"[Gemini] Vision model: gemini-2.5-flash","timestamp":"2025-10-20T18:56:19.259Z"}
{"level":"info","message":"[OpenRouter] Default model: x-ai/grok-4-fast","timestamp":"2025-10-20T18:56:19.259Z"}
{"level":"info","message":"[HEALTH] Script executed directly, starting bootstrap...","timestamp":"2025-10-20T18:56:19.473Z"}
{"level":"info","message":"[HEALTH] Starting application bootstrap...","timestamp":"2025-10-20T18:56:19.473Z"}
{"level":"info","message":"[HEALTH] Environment: development","timestamp":"2025-10-20T18:56:19.474Z"}
{"level":"info","message":"[HEALTH] Platform: linux","timestamp":"2025-10-20T18:56:19.474Z"}
{"level":"info","message":"[HEALTH] Architecture: x64","timestamp":"2025-10-20T18:56:19.474Z"}
{"error":"connect ECONNREFUSED 127.0.0.1:6379","level":"warn","message":"Redis cache error, falling back to no-cache mode","timestamp":"2025-10-20T18:56:19.485Z"}
{"level":"warn","message":"Redis cache connection closed","timestamp":"2025-10-20T18:56:19.485Z"}
{"error":"Connection is closed.","level":"warn","message":"Failed to connect to Redis cache","timestamp":"2025-10-20T18:56:19.486Z"}
{"level":"info","message":"Using memory store for rate limiting (Redis disabled for beta)","timestamp":"2025-10-20T18:56:19.488Z"}
{"level":"info","message":"Rate limiter using memory store for api","timestamp":"2025-10-20T18:56:19.488Z"}
{"level":"info","message":"Rate limiter using memory store for posts","timestamp":"2025-10-20T18:56:19.490Z"}
{"level":"info","message":"Rate limiter using memory store for captions","timestamp":"2025-10-20T18:56:19.491Z"}
{"level":"info","message":"Rate limiter using memory store for default","timestamp":"2025-10-20T18:56:19.492Z"}
{"endpoints":["api","auth","posting","captions","upload","feedback","passwordReset"],"level":"info","message":"Rate limiting middleware configured","redisAvailable":false,"timestamp":"2025-10-20T18:56:19.492Z"}
{"level":"info","message":"Advanced rate limiting applied","timestamp":"2025-10-20T18:56:19.492Z"}
{"level":"info","message":"Observability middleware configured","timestamp":"2025-10-20T18:56:19.496Z"}
{"level":"info","message":"Observability middleware applied","timestamp":"2025-10-20T18:56:19.496Z"}
{"level":"info","message":"Session store configured with PostgreSQL backend","timestamp":"2025-10-20T18:56:19.498Z"}
{"apiPrefix":"/api","level":"info","loginRoute":"/api/auth/login","message":"Setting up auth routes","signupRoute":"/api/auth/signup","timestamp":"2025-10-20T18:56:19.499Z"}
{"error":"connect ECONNREFUSED 127.0.0.1:6379","level":"warn","message":"Redis cache error, falling back to no-cache mode","timestamp":"2025-10-20T18:56:19.586Z"}
{"level":"warn","message":"Redis cache connection closed","timestamp":"2025-10-20T18:56:19.586Z"}
{"error":"connect ECONNREFUSED 127.0.0.1:6379","level":"warn","message":"Redis cache error, falling back to no-cache mode","timestamp":"2025-10-20T18:56:19.787Z"}
{"level":"warn","message":"Redis cache connection closed","timestamp":"2025-10-20T18:56:19.787Z"}
{"error":"connect ECONNREFUSED 127.0.0.1:6379","level":"warn","message":"Redis cache error, falling back to no-cache mode","timestamp":"2025-10-20T18:56:20.088Z"}
{"level":"warn","message":"Redis connection failed after 3 retries, disabling cache","timestamp":"2025-10-20T18:56:20.088Z"}
{"level":"warn","message":"Redis cache connection closed","timestamp":"2025-10-20T18:56:20.089Z"}
{"email":"admin@thottopilot.com","level":"info","message":"Admin account configured successfully","timestamp":"2025-10-20T18:56:21.074Z","username":"admin@thottopilot.com"}
{"level":"info","message":"🔧 Applying production database fixes...","timestamp":"2025-10-20T18:56:21.075Z"}
{"level":"info","message":"✅ Admin account verified: admin@thottopilot.com","timestamp":"2025-10-20T18:56:21.213Z"}
{"level":"info","message":"User a1davida1 already has tier: pro","timestamp":"2025-10-20T18:56:21.305Z"}
{"level":"info","message":"User a1davida1 email already verified","timestamp":"2025-10-20T18:56:21.395Z"}
{"level":"info","message":"✅ Production database fixes completed","timestamp":"2025-10-20T18:56:21.396Z"}
{"level":"info","message":"Initializing queue system...","timestamp":"2025-10-20T18:56:21.397Z"}
{"level":"info","message":"Queue backend selection: USE_PG_QUEUE=true, REDIS_URL=true","timestamp":"2025-10-20T18:56:21.398Z"}
{"level":"info","message":"🔧 Using PostgreSQL queue backend","timestamp":"2025-10-20T18:56:21.398Z"}
{"level":"error","message":"🔧 Initializing PostgreSQL Queue backend","timestamp":"2025-10-20T18:56:21.398Z"}
{"level":"info","message":"Queue system initialized","timestamp":"2025-10-20T18:56:21.399Z"}
{"level":"info","message":"Sentry initialized successfully","timestamp":"2025-10-20T21:57:55.651Z"}
{"level":"info","message":"[Gemini] Text model: gemini-2.5-flash","timestamp":"2025-10-20T21:57:56.873Z"}
{"level":"info","message":"[Gemini] Vision model: gemini-2.5-flash","timestamp":"2025-10-20T21:57:56.873Z"}
{"level":"info","message":"[OpenRouter] Default model: x-ai/grok-4-fast","timestamp":"2025-10-20T21:57:56.873Z"}
{"level":"info","message":"[HEALTH] Script executed directly, starting bootstrap...","timestamp":"2025-10-20T21:57:57.215Z"}
{"level":"info","message":"[HEALTH] Starting application bootstrap...","timestamp":"2025-10-20T21:57:57.216Z"}
{"level":"info","message":"[HEALTH] Environment: development","timestamp":"2025-10-20T21:57:57.216Z"}
{"level":"info","message":"[HEALTH] Platform: linux","timestamp":"2025-10-20T21:57:57.216Z"}
{"level":"info","message":"[HEALTH] Architecture: x64","timestamp":"2025-10-20T21:57:57.216Z"}
{"error":"connect ECONNREFUSED 127.0.0.1:6379","level":"warn","message":"Redis cache error, falling back to no-cache mode","timestamp":"2025-10-20T21:57:57.225Z"}
{"level":"warn","message":"Redis cache connection closed","timestamp":"2025-10-20T21:57:57.225Z"}
{"error":"Connection is closed.","level":"warn","message":"Failed to connect to Redis cache","timestamp":"2025-10-20T21:57:57.225Z"}
{"level":"info","message":"Using memory store for rate limiting (Redis disabled for beta)","timestamp":"2025-10-20T21:57:57.228Z"}
{"level":"info","message":"Rate limiter using memory store for api","timestamp":"2025-10-20T21:57:57.228Z"}
{"level":"info","message":"Rate limiter using memory store for posts","timestamp":"2025-10-20T21:57:57.230Z"}
{"level":"info","message":"Rate limiter using memory store for captions","timestamp":"2025-10-20T21:57:57.230Z"}
{"level":"info","message":"Rate limiter using memory store for default","timestamp":"2025-10-20T21:57:57.231Z"}
{"endpoints":["api","auth","posting","captions","upload","feedback","passwordReset"],"level":"info","message":"Rate limiting middleware configured","redisAvailable":false,"timestamp":"2025-10-20T21:57:57.231Z"}
{"level":"info","message":"Advanced rate limiting applied","timestamp":"2025-10-20T21:57:57.232Z"}
{"level":"info","message":"Observability middleware configured","timestamp":"2025-10-20T21:57:57.237Z"}
{"level":"info","message":"Observability middleware applied","timestamp":"2025-10-20T21:57:57.237Z"}
{"level":"info","message":"Session store configured with PostgreSQL backend","timestamp":"2025-10-20T21:57:57.239Z"}
{"apiPrefix":"/api","level":"info","loginRoute":"/api/auth/login","message":"Setting up auth routes","signupRoute":"/api/auth/signup","timestamp":"2025-10-20T21:57:57.239Z"}
{"error":"connect ECONNREFUSED 127.0.0.1:6379","level":"warn","message":"Redis cache error, falling back to no-cache mode","timestamp":"2025-10-20T21:57:57.327Z"}
{"level":"warn","message":"Redis cache connection closed","timestamp":"2025-10-20T21:57:57.328Z"}
{"error":"connect ECONNREFUSED 127.0.0.1:6379","level":"warn","message":"Redis cache error, falling back to no-cache mode","timestamp":"2025-10-20T21:57:57.529Z"}
{"level":"warn","message":"Redis cache connection closed","timestamp":"2025-10-20T21:57:57.530Z"}
{"error":"connect ECONNREFUSED 127.0.0.1:6379","level":"warn","message":"Redis cache error, falling back to no-cache mode","timestamp":"2025-10-20T21:57:57.830Z"}
{"level":"warn","message":"Redis connection failed after 3 retries, disabling cache","timestamp":"2025-10-20T21:57:57.831Z"}
{"level":"warn","message":"Redis cache connection closed","timestamp":"2025-10-20T21:57:57.832Z"}
{"email":"admin@thottopilot.com","level":"info","message":"Admin account configured successfully","timestamp":"2025-10-20T21:57:58.391Z","username":"admin@thottopilot.com"}
{"level":"info","message":"🔧 Applying production database fixes...","timestamp":"2025-10-20T21:57:58.391Z"}
{"level":"info","message":"✅ Admin account verified: admin@thottopilot.com","timestamp":"2025-10-20T21:57:58.622Z"}
{"level":"info","message":"User a1davida1 already has tier: pro","timestamp":"2025-10-20T21:57:58.712Z"}
{"level":"info","message":"User a1davida1 email already verified","timestamp":"2025-10-20T21:57:58.891Z"}
{"level":"info","message":"✅ Production database fixes completed","timestamp":"2025-10-20T21:57:58.891Z"}
{"level":"info","message":"Initializing queue system...","timestamp":"2025-10-20T21:57:58.894Z"}
{"level":"info","message":"Queue backend selection: USE_PG_QUEUE=true, REDIS_URL=true","timestamp":"2025-10-20T21:57:58.894Z"}
{"level":"info","message":"🔧 Using PostgreSQL queue backend","timestamp":"2025-10-20T21:57:58.894Z"}
{"level":"error","message":"🔧 Initializing PostgreSQL Queue backend","timestamp":"2025-10-20T21:57:58.894Z"}
{"level":"info","message":"Queue system initialized","timestamp":"2025-10-20T21:57:58.895Z"}
{"level":"error","message":"🔍 Starting queue monitoring...","timestamp":"2025-10-20T21:57:58.901Z"}
